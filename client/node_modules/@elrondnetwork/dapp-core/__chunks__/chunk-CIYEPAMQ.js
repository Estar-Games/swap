import{a as A}from"./chunk-YTL3XDSH.js";import{a as F}from"./chunk-XOCOOZKB.js";import{a as P}from"./chunk-FCRYADDX.js";import{c as I,f as q}from"./chunk-7VRNE5H2.js";import{b as $,e as H,f as W,h as j}from"./chunk-W6LR3W2N.js";import{a as ir}from"./chunk-5MXO4P4P.js";import{h as Y,i as _,j as J,k as X}from"./chunk-IJ6N7P6P.js";import{c as R,e as b}from"./chunk-RVI5KZYP.js";import{a as L,b as N}from"./chunk-EWQFS7NK.js";import{b as y}from"./chunk-JAGHGL47.js";import{a as S}from"./chunk-EJQKIB5I.js";import{a as or}from"./chunk-WZI7N45Z.js";import{a as rr,b as tr}from"./chunk-FVNTWDXO.js";import{b as er,c as nr}from"./chunk-652FPKRR.js";import{a as D,b as Z}from"./chunk-7YJZIEAA.js";import{b as O,c as V,e as B}from"./chunk-AXKBBYAP.js";import{a as u}from"./chunk-QD5WEIVN.js";import{b as Q}from"./chunk-SEXJSOIC.js";import{a as K}from"./chunk-MT7A6LPZ.js";import{d}from"./chunk-N5CEAHUR.js";import{b as sr}from"./chunk-MDPKQI3Z.js";import{k as G}from"./chunk-OZ6SMI6T.js";import{c as U}from"./chunk-NUHK4PKO.js";import{a as E,b as C,e as l,f as s,g as o}from"./chunk-YMWLFVZR.js";o();o();o();o();o();o();import{Address as Tr,TransactionPayload as qr}from"@elrondnetwork/erdjs";o();o();o();import{configureStore as Ir}from"@reduxjs/toolkit";import{createSubscription as Pr}from"react-redux/es/utils/Subscription";import{persistStore as Dr,persistReducer as Rr,FLUSH as br,REHYDRATE as vr,PAUSE as Lr,PERSIST as Nr,PURGE as Fr,REGISTER as Mr,createMigrate as kr}from"redux-persist";import zr from"redux-persist/lib/storage";o();import hr from"lodash.throttle";o();o();var Ar=r=>{y.local.setItem({key:S.logoutEvent,data:r,expires:0}),y.local.removeItem(S.logoutEvent)};function at(r,t){return l(this,null,function*(){let e=d(),i=sr(e),n=cr(),f=i==="wallet";if(!(!n||!e)){try{let m=yield h();Ar(m)}catch(m){console.error("error fetching logout address",m)}f&&rr(),a.dispatch(D());try{let g=f&&!r?window.location.origin:r;yield e.logout({callbackUrl:g}),r&&i!=="wallet"&&(typeof t=="function"?t(r):tr(r))}catch(m){console.error("error logging out",m)}}})}o();o();var ft=r=>a.dispatch(er(r)),lt=r=>a.dispatch(nr(r));o();o();function St(){return $(a.getState())}o();function wt(){return H(a.getState())}o();function Pt(){return j(a.getState())}var wr=[G],Er=hr(()=>{N(L())},5e3),Cr=r=>t=>e=>{var T;if(wr.includes(e.type))return t(e);let i=r.getState(),n=y.local.getItem(S.loginExpiresAt);if(!((T=i==null?void 0:i.loginInfo)==null?void 0:T.isLoggedIn))return t(e);if(n==null)return N(L());let m=Date.now();return n-m<0?setTimeout(()=>l(void 0,null,function*(){let x=d();console.log("session expired"),r.dispatch(D());try{yield x==null?void 0:x.logout({callbackUrl:"/"})}catch(yr){console.error("error logging out",yr)}}),1e3):(Er(),t(e))},pr=Cr;var Ur={2:r=>C(E({},r),{networkConfig:or})},Or={key:"dapp-core-store",version:2,storage:zr,whitelist:["account","loginInfo","modals","networkConfig"],migrate:kr(Ur,{debug:!1})},Vr=Rr(Or,ir),a=Ir({reducer:Vr,middleware:r=>r({serializableCheck:{ignoredActions:[br,vr,Lr,Nr,Fr,Mr,b.type,R.type],ignoredPaths:["payload.nonce","account.account.nonce","providers.accountProvider"]}}).concat(pr)}),lo=Pr(a),uo=Dr(a);function h(){let{search:r}=window.location,t=a.getState(),e=d(),i=O(t),n=I(t),f=q(t);if(!e)throw"provider not initialized";return A("ledger")&&n?new Promise(m=>{m(i)}):!A("")&&!A("wallet")&&!A("extra")?e.getAddress():new Promise(m=>{if(f!=null){let g=new URLSearchParams(r),T=Object.fromEntries(g);P(T.address)&&m(T.address)}n&&m(i),m("")})}var mr=h;o();o();import Br from"axios";o();o();var fr=r=>{let t=r!=null?r:W(a.getState());return t.endsWith("/")?t.slice(0,-1):t};function lr(r){return l(this,null,function*(){var i;if(!r)return null;let e=`${fr()}/${U}/${r}`;try{let{data:n}=yield Br.get(e);if(n!=null)return(i=n==null?void 0:n.data)==null?void 0:i.account}catch(n){console.error("error fetching configuration for ",e)}return null})}function M(r){return l(this,null,function*(){return yield lr(r)})}var dr=M;o();function zo(r){a.dispatch(b(r))}o();function $r(r){let t=a.getState(),e=B(t);return r?e&&!isNaN(e)?Math.max(e,r.nonce):r.nonce:e}var ur=$r;o();function jo(r){return l(this,null,function*(){let t=r;t==null&&(t=V(a.getState()).address);let e=yield M(t);if(e==null)throw"Could not read account, user not logged in";return e==null?void 0:e.balance})}o();var gr=()=>l(void 0,null,function*(){try{let r=yield mr();try{let t=yield dr(r);if(t!=null){let e={balance:t.balance,address:r,nonce:ur(t),username:t.username};return a.dispatch(R(e)),e}}catch(t){console.error("Failed getting account ",t)}}catch(r){console.error("Failed getting address ",r)}return null});function Xo(){return l(this,null,function*(){let r=d();if(r==null)throw"Provider not initialized";if(!r.isInitialized||r.isInitialized())return gr();try{if(!r.init)throw"Current provider does not have init() function";return(yield r.init())?gr():void 0}catch(t){console.error("Failed initializing provider ",t)}})}o();import{SignableMessage as Hr,Address as Wr}from"@elrondnetwork/erdjs";function jr(e){return l(this,arguments,function*({message:r,callbackRoute:t}){let i=yield h(),n=d(),f=`${window.location.origin}${t}`,m=new Hr({address:new Wr(i),message:s.Buffer.from(r,"ascii")});return yield n.signMessage(m,{callbackUrl:encodeURIComponent(f)})})}var ee=jr;o();function ce(r){a.dispatch(Z({address:r,loginMethod:"extra"}))}var Gr=["ESDTNFTTransfer","ESDTNFTBurn","ESDTNFTAddQuantity","ESDTNFTCreate","MultiESDTNFTTransfer","ESDTTransfer","ESDTBurn","ESDTLocalMint","ESDTLocalBurn","ESDTWipe","ESDTFreeze"];function Kr(r,t,e=""){if(!P(r))return!1;if(new Tr(r).isContractAddress())return!0;let f=k({receiver:r,data:e});return f?new Tr(f).isContractAddress()||_r(r,t,e):!1}var Qr=r=>r.toLowerCase().match(/[0-9a-f]/g),Yr=r=>r.length%2===0;function _r(r,t,e){let i=e==null?void 0:e.split("@");if(i==null)return!1;let[n,...f]=i,m=t!=null&&r!=null&&r===t,g=Gr.includes(n),T=f.every(x=>Qr(x)&&Yr(x));return m&&g&&T}function k({receiver:r,data:t}){try{if(!t)return r;let e=K(t)?qr.fromEncoded(t).toString():t,i=Jr(e),n=e.split("@");return i>-1?n[i]:r}catch(e){console.log(e);return}}function Jr(r){return r.includes("MultiESDTNFTTransfer")?1:r.includes("ESDTNFTTransfer")?4:-1}var be=Kr;o();import{Address as xr}from"@elrondnetwork/erdjs/out";function Sr({receiverAddress:r,senderShard:t,senderAddress:e}){try{let i=new xr(r),n=F(i.pubkey());if(t==null&&e!=null){let f=new xr(e);return F(f)===n}return n===t}catch(i){return!1}}var ze=(r,t=1)=>r!=null?r.reduce((e,{receiver:i,data:n})=>{let f=k({receiver:i,data:n!=null?n:""});return f==null?e:e&&Sr({receiverAddress:f,senderShard:t})},!0):!0;var z=r=>r.transactions,w=u(z,r=>r.signedTransactions),Ye=u(z,r=>r.signTransactionsError),v=r=>t=>Object.entries(t).reduce((e,[i,n])=>(r(n.status)&&(e[i]=n),e),{}),_e=u(w,v(Y)),Je=u(w,v(_)),Xe=u(w,v(J)),Ze=u(w,v(X)),rn=u(z,r=>{var t;return(r==null?void 0:r.transactionsToSign)==null?null:C(E({},r.transactionsToSign),{transactions:((t=r==null?void 0:r.transactionsToSign)==null?void 0:t.transactions.map(e=>Q(e)))||[]})}),tn=u(w,(r,t)=>t,(r,t)=>t!=null?(r==null?void 0:r[t])||{}:{});function cr(){return I(a.getState())}export{cr as a,at as b,ft as c,lt as d,St as e,wt as f,Pt as g,Cr as h,pr as i,a as j,lo as k,uo as l,h as m,mr as n,M as o,dr as p,zo as q,$r as r,ur as s,jo as t,Xo as u,jr as v,ee as w,ce as x,Gr as y,Kr as z,_r as A,k as B,be as C,Sr as D,ze as E,z as F,w as G,Ye as H,_e as I,Je as J,Xe as K,Ze as L,rn as M,tn as N,fr as O,lr as P};
//# sourceMappingURL=chunk-CIYEPAMQ.js.map
