import{a as j}from"./chunk-UK3KZYBG.js";import{c as O,d as n}from"./chunk-5WWDE5CH.js";import{a as _}from"./chunk-WSEUXKQ7.js";import{b as h,m as v,o as A,r as U}from"./chunk-CIYEPAMQ.js";import{b as I,c as y,d as E,e as S,f as W}from"./chunk-7VRNE5H2.js";import{e as C}from"./chunk-W6LR3W2N.js";import{c as m,g as M,j as w,k as R}from"./chunk-RVI5KZYP.js";import{g as z}from"./chunk-EU6LW3Z6.js";import{d as F}from"./chunk-WZI7N45Z.js";import{b as D}from"./chunk-7YJZIEAA.js";import{b as x,g as k}from"./chunk-AXKBBYAP.js";import{a as s,c as N}from"./chunk-N5CEAHUR.js";import{c as p,d as H}from"./chunk-MDPKQI3Z.js";import{e as r,g as P}from"./chunk-YMWLFVZR.js";P();import{useEffect as u,useState as te}from"react";import{ExtensionProvider as oe}from"@elrondnetwork/erdjs-extension-provider";import{HWProvider as ne}from"@elrondnetwork/erdjs-hw-provider";function re(){let f=n(C),L=n(E),g=n(I),q=n(W),a=n(x),b=n(k),i=n(S),l=n(y),[d,B]=te(),o=O(),{callbackRoute:G,logoutRoute:J}=L||{callbackRoute:"",logoutRoute:""},[K]=j({callbackRoute:G,logoutRoute:J});u(()=>{Q()},[f]),u(()=>{ee()},[g]),u(()=>{V()},[a,l]),u(()=>{T()},[b,l,d]);function Q(){return r(this,null,function*(){try{let e=yield _();e&&o(F(e.erd_chain_id))}catch(e){console.error("failed refreshing chainId ",e)}})}function T(){b==null&&i!=null&&d&&o(M({index:i.index,address:a,hasContractDataEnabled:d.dataEnabled,version:d.version}))}function V(){return r(this,null,function*(){if(o(w(!0)),a&&l)try{let e=yield A(a);e&&o(m({balance:e.balance,address:a,nonce:e.nonce.valueOf(),username:e.username}))}catch(e){o(R("Failed getting account")),console.error("Failed getting account ",e)}o(w(!1))})}function X(){return r(this,null,function*(){try{if(q!=null){let e=p(f.walletAddress),t=yield v();if(t){s(e),o(D({address:t,loginMethod:"wallet"}));let c=yield A(t);c&&o(m({balance:c.balance,address:t,nonce:U(c),username:c.username}))}o(z(null))}}catch(e){console.error("Failed authenticating wallet user ",e)}})}function Y(){return r(this,null,function*(){let e=new ne,t=e.isInitialized();if(t||(t=yield e.init()),!t&&l){console.warn("Could not initialise ledger app"),h();return}return(i==null?void 0:i.index)!=null&&(e.addressIndex=i.index),e})}function Z(){return r(this,null,function*(){try{let e=yield Y();if(!e)return;let t=yield H(e);s(e),B(t)}catch(e){console.error("Could not initialise ledger app",e),h()}})}function $(){return r(this,null,function*(){try{let e=yield v(),t=oe.getInstance().setAddress(e);(yield t.init())?s(t):console.error("Could not initialise extension, make sure Elrond wallet extension is installed.")}catch(e){console.error("Unable to login to ExtensionProvider",e)}})}function ee(){if(g!=null)switch(g){case"ledger":{Z();break}case"walletconnect":{K(!1);break}case"wallet":{let e=p(f.walletAddress);s(e);break}case"extension":{$();break}case"extra":{N();break}case"":{X();break}default:return}}return null}export{re as a};
//# sourceMappingURL=chunk-ZB7MPFCB.js.map
