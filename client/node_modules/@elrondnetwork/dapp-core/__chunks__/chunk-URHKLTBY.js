import{a as E}from"./chunk-BOARPJT6.js";import{a as w}from"./chunk-IKL5RLRZ.js";import{a as k}from"./chunk-XJJEEDNX.js";import{a as P}from"./chunk-YTL3XDSH.js";import{a as F}from"./chunk-CQECN6DM.js";import{a as c,e as p,g as M}from"./chunk-YMWLFVZR.js";M();import{useEffect as en,useState as g}from"react";var l={};function tn({transactionsToSign:R,egldLabel:C,address:U,verifyReceiverScam:W=!0,onCancel:B,onSignTransaction:N,onTransactionsSignError:V,onTransactionsSignSuccess:j}){var x,D,b;let[r,o]=g(0),[d,S]=g(),[e,q]=g(null),[O,f]=g(!1),m=P("ledger"),{getTxInfoByDataField:z,allTransactions:s}=E({transactions:R}),T=r===s.length-1;en(()=>{G()},[r,s]);function G(){return p(this,null,function*(){var A;let n=s[r];if(n==null)return;let{transaction:t,multiTxData:i}=n,u=t.getData().toString(),I=z(t.getData().toString(),i),{tokenId:h}=I,a=t.getReceiver().toString(),_=U!==a,$=a in l;if(_&&!$&&W){let L=yield w(a);l=c(c({},l),L.scamInfo?{[a]:L.scamInfo}:{})}let nn=Boolean(h&&k({tokenId:h,erdLabel:C}));q({transaction:t,receiverScamInfo:((A=l[a])==null?void 0:A.info)||null,transactionTokenInfo:I,isTokenTransaction:nn,dataField:u})})}function v(){o(0),S(void 0),f(!1)}function y(){return p(this,null,function*(){try{if(e==null)return;f(m);let n=yield N(e.transaction),t={[r]:n},i=d?c(c({},d),t):t;S(i),T?i&&(j(Object.values(i)),v()):(o(u=>u+1),f(!1))}catch(n){console.error(n,"sign error");let{message:t}=n,i=m?F(n).errorMessage:null;v(),V(i!=null?i:t)}})}function H(){try{if(e==null)return;e.transaction.getSignature().hex()?T||o(t=>t+1):y()}catch(n){y()}}let J=r===0;function K(){J?B():o(n=>n-1)}let Q=((x=e==null?void 0:e.transactionTokenInfo)==null?void 0:x.type)&&((D=e==null?void 0:e.transactionTokenInfo)==null?void 0:D.multiTxData)&&!(e!=null&&e.dataField.endsWith((b=e==null?void 0:e.transactionTokenInfo)==null?void 0:b.multiTxData));function X(){Q?o(n=>n+1):H()}function Y(){o(n=>{let t=n+1;return t>(s==null?void 0:s.length)?n:t})}function Z(){o(n=>{let t=n-1;return t<0?n:t})}return{allTransactions:s,onSignTransaction:X,onNext:Y,onPrev:Z,waitingForDevice:O,onAbort:K,isLastTransaction:T,currentStep:r,signedTransactions:d,currentTransaction:e}}var un=tn;export{tn as a,un as b};
//# sourceMappingURL=chunk-URHKLTBY.js.map
